package com.hartwig.hmftools.store

import com.hartwig.hmftools.bedpe.Breakend
import org.junit.Assert
import org.junit.Test

class LocationTest {

    @Test
    fun testBEALN() {
        val line = "X:52729547|+|608M|0,X:52786405|-|608M|,X:48209476|+|608M|".split(",")
        val breakends = line.map { Breakend.fromBealn(it) }

        Assert.assertEquals(Breakend("X", 52729547, 52729547, 1), breakends[0])
        Assert.assertEquals(Breakend("X", 52786405, 52786405, -1), breakends[1])
        Assert.assertEquals(Breakend("X", 48209476, 48209476, 1), breakends[2])
    }

    @Test
    fun testHG38BEALN() {
        val line="chr6:29889279|+|4S50M1I188M1S|0,chr6:29944073|+|4S50M2I187M1S|,HLA-A*01:04N:1737|+|4S50M1I188M1S|,HLA-A*03:21N:1520|+|4S50M1I188M1S|,HLA-A*01:03:1821|+|4S50M2I187M1S|,HLA-A*30:02:01:01:1521|+|4S50M2I187M1S|,HLA-A*11:25:1521|+|4S50M2I187M1S|,HLA-A*01:14:1521|+|4S50M2I187M1S|,HLA-A*01:20:1521|+|4S50M2I187M1S|,HLA-A*03:36N:1724|+|4S50M2I187M1S|,HLA-A*11:110:1521|+|4S50M2I187M1S|,HLA-A*11:75:1592|+|4S50M2I187M1S|,HLA-A*01:01:01:02N:1738|+|4S50M2I187M1S|,HLA-A*11:77:1642|+|4S50M2I187M1S|,HLA-A*03:01:01:03:1520|+|4S50M2I187M1S|,HLA-A*01:01:01:01:1821|+|4S50M2I187M1S|,HLA-A*36:01:1521|+|4S50M2I187M1S|,HLA-A*11:50Q:1809|+|4S50M2I187M1S|,HLA-A*01:16N:1543|+|4S50M2I187M1S|,HLA-A*11:05:1821|+|4S50M2I187M1S|,HLA-A*11:01:01:1821|+|4S50M2I187M1S|,HLA-A*11:60:1653|+|4S50M2I187M1S|,HLA-A*30:04:01:1821|+|4S50M2I187M1S|,HLA-A*03:01:01:02N:1820|+|4S50M2I187M1S|,chr6_GL000250v2_alt:1201821|+|4S50M2I187M1S|,HLA-A*30:89:1521|+|4S50M2I187M1S|,HLA-A*01:09:1521|+|4S50M2I187M1S|,HLA-A*30:02:01:02:1821|+|4S50M2I187M1S|,HLA-A*01:11N:1821|+|4S50M2I187M1S|,HLA-A*11:01:18:1821|+|4S50M2I187M1S|,HLA-A*01:02:1821|+|4S50M2I187M1S|,HLA-A*11:02:01:1821|+|4S50M2I187M1S|,HLA-A*11:74:1638|+|4S50M2I187M1S|,chr6_GL000251v2_alt:1423496|+|4S50M2I187M1S|,HLA-A*03:01:01:01:1820|+|4S50M2I187M1S|,HLA-A*03:02:01:1820|+|4S50M2I187M1S|,HLA-A*30:01:01:1821|+|4S50M2I187M1S|,HLA-A*03:11N:1820|+|4S50M2I187M1S|,HLA-A*11:69N:1818|+|4S50M2I187M1S|,HLA-A*01:01:38L:1821|+|4S50M2I187M1S|,chr6_GL000250v2_alt:1149012|+|4S50M2I129M1I57M1S|,chr6_GL000251v2_alt:1370686|+|4S50M2I129M1I57M1S|,HLA-A*24:11N:1821|+|4S50M1I187M2S|,HLA-A*34:01:01:1842|+|4S50M2I188M|,HLA-A*31:14N:1541|+|4S50M1I189M|,HLA-A*31:01:23:1541|+|4S50M2I188M|,HLA-A*31:04:1541|+|4S50M2I188M|,HLA-A*33:03:01:1841|+|4S50M2I188M|,HLA-A*34:02:01:1721|+|4S50M2I188M|,HLA-A*31:01:02:1841|+|4S50M2I188M|".split(",")
        val breakends = line.map { Breakend.fromBealn(it) }
        Assert.assertEquals(Breakend("chr6", 29889279, 29889279, 1), breakends[0])
        Assert.assertEquals(Breakend("chr6", 29944073, 29944073, 1), breakends[1])
        Assert.assertEquals(Breakend("HLA-A*01:04N", 1737, 1737, 1), breakends[2])
    }

}
